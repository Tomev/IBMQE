---
title: "Untitled"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message=FALSE,
                      fig.width=12, fig.height=7)
source('~/QE/Analysis/analysis_methods.R')
```

How to process Mermin with CHSH test
```{r}
data = read_csv('JT_Mermin.csv')
data %>% print_basic_info

data %<>% chsh_test
data %<>% filter(good)

data %<>% process_mermin

mermin = data %>% agg_data
mermin %>% summary_table

mermin_signaling = data %>% process_signaling
mermin_signaling %>% plot_signaling
```

How to process CHSH
```{r}
data = read_csv('CHSH_no_signaling.csv')
data %>% print_basic_info

data %<>% process_chsh

data %<>% group_by(theta0, theta)

chsh = data %>% agg_data
chsh %>% summary_table(theta0)
chsh %>% chsh_plot

chsh_signaling = data %>% process_signaling
chsh_signaling %>%
  filter(qubit == "1") %>%
  plot_signaling(x = quo(theta), facet_x = quo(my_base))
```
